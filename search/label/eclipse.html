
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

    <base href="../../" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="keywords" content="Web-разработка, PHP, Javascript, jQuery, Joomla, eclipse" />
    <meta name="rights" content="teafortwo.ru" />
    <meta name="description" content="разработка плагинов для Eclipse, Web-разработка, разработка расширений для joomla, программные разработки для изучения иностранных языков" />
    <meta name="generator" content="Psytronica.ru" />
    <meta content='IE=edge' http-equiv='X-UA-Compatible'/>
    <meta content='width=device-width, initial-scale=1' name='viewport'/>
	<meta name="yandex-verification" content="70dcadaa2851af41" />
	<link href="./yinyang.ico" rel="shortcut icon" type="image/vnd.microsoft.icon" />

    <title>Psytronica.ru - Web-разработка, инстранные языки, Eclipse и разные разности - eclipse</title>
    <link rel="stylesheet" href="./css/psytronica1.css" type="text/css" media="screen" /> 
    <script src="./js/psytronica2.js" type="text/javascript"></script>




</head>
<body id='psy_body_search_label_eclipse' onload="setBodyWidth();">
<div id="psy_body_inner">

<div id="psytronica_menu_wrapper">
    <div id="psytronica_menu" class="ddsmoothmenu">


        <ul>
            <li><a href='./index.html' class='psy_noactive'>Главная</a></li>
            <li><a href='./search/label/разработки.html' class='psy_noactive'>Мои разработки</a>
            </li>
          <li><a href='./me.html' class='psy_noactive'>Контакты</a></li>
        </ul>



	<div id="psytronica_search" class='psy_search_div'>
		  <input type="text" id='psy_search'  title="keyword" placeholder="Поиск..."/>
		  <div id='psy_search_results'></div>
	</div>

        <br style="clear: left" />
    </div> <!-- end of psytronica_menu -->
</div> <!-- end of psytronica_menu_wrapper -->


<div id="psytronica_header_wrapper" class="psytronica_header_other">
    <div id="psytronica_header" class="header_home">
        
<div id="psytronica_sitetitle_bar">
    <div id="site_title"><h1><a href='./index.html' class='psy_noactive'>Psytronica</a></h1></div>

    <div id="mid_title">
        Web-разработка, иностранные языки, Eclipse  и разные разности
    </div>
    <div class="cleaner"></div>
</div>

        

    </div> <!-- end of header -->
</div> <!-- end of header_wrapper -->


<div id="psytronica_after_header">

            <h3><a href='./2015/10/joomla-3x-zygoprofile-hkmprofile.html' class='psy_noactive'>Zygo Profile</a></h3>
            <h3><a href='./2016/10/shabdatra.html' class='psy_noactive'>Санскрит - словоформы</a></h3>
            <h3><a href='./2015/10/verbos-irregulares-android-kivy-python.html' class='psy_noactive'>Verbos Irregulares</a></h3>

</div>







<a name="blog"></a>

<div id="psytronica_main_wrapper">

    <div id="psytronica_main_inner">
        <div id="psytronica_main">
            <div id="psytronica_content_area">

                
<h3 class="psy_content_head psy_content_head_tag">Eclipse</h3>
 
<div id="psytronica_blog">

<div class="psytronica_post even  psy_post_tags">
    <h2><a href="./2017/03/eclipse-wizard-open-programmatically.html">Вызов wizard'а в Eclipse по кнопке или по shortcut'y в меню</a></h2>

    <div class="date"><div class='psy_page_date'>07.03.2017</div></div>

    <div class="psytronica_post_content" >
        
<img class='imgplain' src="./images/eclipse/logo.png" align="left" style="width:100px; margin-right:10px;" />Периодически у меня возникает задача вызывать в Eclipse определенный wizard непосредственно из кода. Например, вызывать wizard по кнопке или по shortcut'y в меню. Конечно, можно решить эту задачку, привязав shortcut wizard'a к определенной  перспективе:
<br /><br /><br />
<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="color: #777; margin: 0; line-height: 125%">1
2
3
4
5
6
7
8</pre></td><td><pre style="margin: 0; line-height: 125%">   <span style="color: #f92672">&lt;extension</span>
         <span style="color: #a6e22e">point=</span><span style="color: #e6db74">&quot;org.eclipse.ui.perspectiveExtensions&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;perspectiveExtension</span>
            <span style="color: #a6e22e">targetID=</span><span style="color: #e6db74">&quot;org.eclipse.jdt.ui.JavaPerspective&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;newWizardShortcut</span>
               <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;my.wizard.id&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;/newWizardShortcut&gt;</span>
<div style="color:#fff; text-align:center">...</div>
</pre></td></tr></table></div>
<br /><br />

Но бывают случаи, когда необходимо отображать shortcut визарда независимо от перспективы.<br /><br />

Уже придумано множество способов решения этого вопроса. В частности, перейдя по ссылке, можно увидеть очень удачный способ - вначале происходит проверка существования визарда, чей id передается в функцию параметром:<br />

<a href="https://resheim.net/2010/07/invoking-eclipse-wizard.html" rel="nofollow">Invoking an Eclipse Wizard programmatically</a><br /><br />

Но у этого способа есть один недостаток: нашему визарду не передается элемент, выбранный в Project Explorer, редакторе или где-то еще. Это может создавать неудобства: в частности, если визард осуществляет создание файла в определенном пакете, визард не получит информацию об этом пакете, даже если пакет выбран в файловом дереве.
<br /><br />
Если класс wizard'a реализует интерфейс <b>IWorkbenchWizard</b>, ему не передается выделенный элемент <b>selection</b> и не передается <b>workbench</b>, поскольку не вызывается функция 
<div class="zecode">init(IWorkbench workbench, IStructuredSelection selection);</div>
Отсуствие <b>workbench</b>, в свою очередь, может приводить к ряду ошибок при вызове таких функций как <b>selectAndReveal</b> и т.д.
<br /><br />
Предлагаемый способ (вместе с хендлером):
<br /><br />
<b>MyHandler.java:</b>
<br /><br />
<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="color: #777; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">public</span> <span style="color: #66d9ef">class</span> <span style="color: #a6e22e">MyHandler</span> <span style="color: #66d9ef">extends</span> <span style="color: #f8f8f2">AbstractHandler</span> <span style="color: #f92672">{</span>

	<span style="color: #a6e22e">@Override</span>
	<span style="color: #66d9ef">public</span> <span style="color: #f8f8f2">Object</span> <span style="color: #a6e22e">execute</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">ExecutionEvent</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">)</span> <span style="color: #66d9ef">throws</span> <span style="color: #f8f8f2">ExecutionException</span> <span style="color: #f92672">{</span>

		<span style="color: #f8f8f2">IWorkbenchWindow</span> <span style="color: #f8f8f2">window</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">HandlerUtil</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getActiveWorkbenchWindowChecked</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">event</span><span style="color: #f92672">);</span>
		<span style="color: #f8f8f2">openWizard</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;my.wizard.id&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">window</span><span style="color: #f92672">);</span>
		<span style="color: #66d9ef">return</span> <span style="color: #66d9ef">null</span><span style="color: #f92672">;</span>
	<span style="color: #f92672">}</span>

	<span style="color: #66d9ef">public</span> <span style="color: #66d9ef">void</span> <span style="color: #a6e22e">openWizard</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">String</span> <span style="color: #f8f8f2">id</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">IWorkbenchWindow</span> <span style="color: #f8f8f2">window</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
		<span style="color: #75715e">// First see if this is a &quot;new wizard&quot;.</span>
		<span style="color: #f8f8f2">IWizardDescriptor</span> <span style="color: #f8f8f2">descriptor</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">PlatformUI</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getWorkbench</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getNewWizardRegistry</span><span style="color: #f92672">().</span><span style="color: #a6e22e">findWizard</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">id</span><span style="color: #f92672">);</span>
		<span style="color: #75715e">// If not check if it is an &quot;import wizard&quot;.</span>
		<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">descriptor</span> <span style="color: #f92672">==</span> <span style="color: #66d9ef">null</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
			<span style="color: #f8f8f2">descriptor</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">PlatformUI</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getWorkbench</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getImportWizardRegistry</span><span style="color: #f92672">().</span><span style="color: #a6e22e">findWizard</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">id</span><span style="color: #f92672">);</span>
		<span style="color: #f92672">}</span>
		<span style="color: #75715e">// Or maybe an export wizard</span>
		<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">descriptor</span> <span style="color: #f92672">==</span> <span style="color: #66d9ef">null</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
			<span style="color: #f8f8f2">descriptor</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">PlatformUI</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getWorkbench</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getExportWizardRegistry</span><span style="color: #f92672">().</span><span style="color: #a6e22e">findWizard</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">id</span><span style="color: #f92672">);</span>
		<span style="color: #f92672">}</span>
		<span style="color: #66d9ef">try</span> <span style="color: #f92672">{</span>
			<span style="color: #75715e">// Then if we have a wizard, open it.</span>
			<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">descriptor</span> <span style="color: #f92672">!=</span> <span style="color: #66d9ef">null</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>

				<span style="color: #f8f8f2">IWizard</span> <span style="color: #f8f8f2">wizard</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">descriptor</span><span style="color: #f92672">.</span><span style="color: #a6e22e">createWizard</span><span style="color: #f92672">();</span>

				<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">wizard</span> <span style="color: #66d9ef">instanceof</span> <span style="color: #f8f8f2">IWorkbenchWizard</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>

					<span style="color: #f8f8f2">IWorkbenchWizard</span> <span style="color: #f8f8f2">wb_wizard</span> <span style="color: #f92672">=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">IWorkbenchWizard</span><span style="color: #f92672">)</span> <span style="color: #f8f8f2">wizard</span><span style="color: #f92672">;</span>

					<span style="color: #f8f8f2">ISelection</span> <span style="color: #f8f8f2">selection</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">window</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getSelectionService</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getSelection</span><span style="color: #f92672">();</span>
					<span style="color: #f8f8f2">IStructuredSelection</span> <span style="color: #f8f8f2">selectionToPass</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">StructuredSelection</span><span style="color: #f92672">.</span><span style="color: #a6e22e">EMPTY</span><span style="color: #f92672">;</span>
					<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">selection</span> <span style="color: #66d9ef">instanceof</span> <span style="color: #f8f8f2">IStructuredSelection</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
						<span style="color: #f8f8f2">selectionToPass</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">descriptor</span><span style="color: #f92672">.</span><span style="color: #a6e22e">adaptedSelection</span><span style="color: #f92672">((</span><span style="color: #f8f8f2">IStructuredSelection</span><span style="color: #f92672">)</span> <span style="color: #f8f8f2">selection</span><span style="color: #f92672">);</span>
					<span style="color: #f92672">}</span> <span style="color: #66d9ef">else</span> <span style="color: #f92672">{</span>
						<span style="color: #75715e">// Build the selection from the IFile of the editor</span>
						<span style="color: #f8f8f2">IWorkbenchPart</span> <span style="color: #f8f8f2">part</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">window</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getPartService</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getActivePart</span><span style="color: #f92672">();</span>
						<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">part</span> <span style="color: #66d9ef">instanceof</span> <span style="color: #f8f8f2">IEditorPart</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
							<span style="color: #f8f8f2">IEditorInput</span> <span style="color: #f8f8f2">input</span> <span style="color: #f92672">=</span> <span style="color: #f92672">((</span><span style="color: #f8f8f2">IEditorPart</span><span style="color: #f92672">)</span> <span style="color: #f8f8f2">part</span><span style="color: #f92672">).</span><span style="color: #a6e22e">getEditorInput</span><span style="color: #f92672">();</span>
							<span style="color: #f8f8f2">Class</span> <span style="color: #f8f8f2">fileClass</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">LegacyResourceSupport</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getFileClass</span><span style="color: #f92672">();</span>
							<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">input</span> <span style="color: #f92672">!=</span> <span style="color: #66d9ef">null</span> <span style="color: #f92672">&amp;&amp;</span> <span style="color: #f8f8f2">fileClass</span> <span style="color: #f92672">!=</span> <span style="color: #66d9ef">null</span> <span style="color: #f92672">&amp;&amp;</span> <span style="color: #f8f8f2">input</span> <span style="color: #66d9ef">instanceof</span> <span style="color: #f8f8f2">IAdaptable</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>

								<span style="color: #f8f8f2">IAdaptable</span> <span style="color: #f8f8f2">adaptable</span> <span style="color: #f92672">=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">IAdaptable</span><span style="color: #f92672">)</span><span style="color: #f8f8f2">input</span><span style="color: #f92672">;</span>
							    <span style="color: #f8f8f2">Object</span> <span style="color: #f8f8f2">file</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">adaptable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getAdapter</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">fileClass</span><span style="color: #f92672">);</span>
								<span style="color: #66d9ef">if</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">file</span> <span style="color: #f92672">!=</span> <span style="color: #66d9ef">null</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
									<span style="color: #f8f8f2">selectionToPass</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">StructuredSelection</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">file</span><span style="color: #f92672">);</span>
								<span style="color: #f92672">}</span>
							<span style="color: #f92672">}</span>
						<span style="color: #f92672">}</span>
					<span style="color: #f92672">}</span>

					<span style="color: #f8f8f2">wb_wizard</span><span style="color: #f92672">.</span><span style="color: #a6e22e">init</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">PlatformUI</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getWorkbench</span><span style="color: #f92672">(),</span> <span style="color: #f8f8f2">selectionToPass</span><span style="color: #f92672">);</span>

				<span style="color: #f92672">}</span>

				<span style="color: #f8f8f2">WizardDialog</span> <span style="color: #f8f8f2">dialog</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">WizardDialog</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">PlatformUI</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getWorkbench</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getDisplay</span><span style="color: #f92672">().</span><span style="color: #a6e22e">getActiveShell</span><span style="color: #f92672">(),</span> <span style="color: #f8f8f2">wizard</span><span style="color: #f92672">);</span>
				<span style="color: #f8f8f2">dialog</span><span style="color: #f92672">.</span><span style="color: #a6e22e">setTitle</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">wizard</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getWindowTitle</span><span style="color: #f92672">());</span>

				<span style="color: #f8f8f2">dialog</span><span style="color: #f92672">.</span><span style="color: #a6e22e">create</span><span style="color: #f92672">();</span>

				<span style="color: #f8f8f2">dialog</span><span style="color: #f92672">.</span><span style="color: #a6e22e">open</span><span style="color: #f92672">();</span>
			<span style="color: #f92672">}</span>
		<span style="color: #f92672">}</span> <span style="color: #66d9ef">catch</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">CoreException</span> <span style="color: #f8f8f2">e</span><span style="color: #f92672">)</span> <span style="color: #f92672">{</span>
			<span style="color: #f8f8f2">e</span><span style="color: #f92672">.</span><span style="color: #a6e22e">printStackTrace</span><span style="color: #f92672">();</span>
		<span style="color: #f92672">}</span>
	<span style="color: #f92672">}</span>

<span style="color: #f92672">}</span>
</pre></td></tr></table></div>
<br /><br />


<b>plugin.xml</b>

<br /><br />
<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="color:#777; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #75715e">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color: #75715e">&lt;?eclipse version=&quot;3.4&quot;?&gt;</span>
<span style="color: #f92672">&lt;plugin&gt;</span>

   <span style="color: #f92672">&lt;extension</span>
         <span style="color: #a6e22e">point=</span><span style="color: #e6db74">&quot;org.eclipse.ui.newWizards&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;category</span>
            <span style="color: #a6e22e">name=</span><span style="color: #e6db74">&quot;My Wizard Category&quot;</span>
            <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;my.wizard.category&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/category&gt;</span>
      <span style="color: #f92672">&lt;wizard</span>
            <span style="color: #a6e22e">category=</span><span style="color: #e6db74">&quot;my.wizard.category&quot;</span>
            <span style="color: #a6e22e">class=</span><span style="color: #e6db74">&quot;my.wizards.myWizardClass&quot;</span>
            <span style="color: #a6e22e">hasPages=</span><span style="color: #e6db74">&quot;true&quot;</span>
            <span style="color: #a6e22e">icon=</span><span style="color: #e6db74">&quot;icons/sample.gif&quot;</span>
            <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;my.wizard.id&quot;</span>
            <span style="color: #a6e22e">name=</span><span style="color: #e6db74">&quot;My Sample New Project Wizard&quot;</span>
            <span style="color: #a6e22e">project=</span><span style="color: #e6db74">&quot;true&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/wizard&gt;</span>
   <span style="color: #f92672">&lt;/extension&gt;</span>

   <span style="color: #f92672">&lt;extension</span>
         <span style="color: #a6e22e">point=</span><span style="color: #e6db74">&quot;org.eclipse.ui.commands&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;category</span>
            <span style="color: #a6e22e">name=</span><span style="color: #e6db74">&quot;My Wizard commands&quot;</span>
            <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;my.wizards.category&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/category&gt;</span>
      <span style="color: #f92672">&lt;command</span>
            <span style="color: #a6e22e">name=</span><span style="color: #e6db74">&quot;Show My Wizard&quot;</span>
            <span style="color: #a6e22e">defaultHandler=</span><span style="color: #e6db74">&quot;my.wizards.MyHandler&quot;</span>
            <span style="color: #a6e22e">categoryId=</span><span style="color: #e6db74">&quot;my.wizards.category&quot;</span>
            <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;my.MyHandler&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/command&gt;</span>
  <span style="color: #f92672">&lt;/extension&gt;</span>   

<span style="color: #f92672">&lt;/plugin&gt;</span>
</pre></td></tr></table></div>


    </div>
    
    <div class='psy_page_tags'><ul class='tags'><li class='blue' ><a href='./search/label/eclipse.html'>eclipse <span>4</span></a></li> <li><a href='./search/label/plug-in_development.html'>plug-in development <span>4</span></a></li> </ul></div>
 

    <div class="cleaner"></div>
</div>
<div class="psytronica_post_intro"></div>

<div class="psytronica_post odd  psy_post_tags">
    <h2><a href="./2017/03/eclipse-custom-project-nature-icons.html">Eclipse: особые иконки в Project Explorer для проекта с определенной Nature</a></h2>

    <div class="date"><div class='psy_page_date'>01.03.2017</div></div>

    <div class="psytronica_post_content" >
        
<img class='imgplain' src="./images/eclipse/logo.png" align="left" style="width:100px; margin-right:10px;" />Периодически появляется необходимость отображать новые иконки в Project Explorer для разных типов ресурсов, в том числе, для проектов с определенной Nature. Приведу возможное решение:
<br /><br />
В начале создается проект плагина (Create > New > Plug-in Project), если еще не создан. Создается plugin.xml
<br /><br />
Решить задачу можно двумя способами:
<br /><br />
<b>1)</b> Создать точку расширения <b>"org.eclipse.ui.ide.projectNatureImages"</b>
<br /><br />
<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="color: #777; margin: 0; line-height: 125%">1
2
3
4
5
6
7</pre></td><td><pre style="margin: 0; line-height: 125%">     <span style="color: #f92672">&lt;extension</span> <span style="color: #a6e22e">point=</span><span style="color: #e6db74">&quot;org.eclipse.ui.ide.projectNatureImages&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;image</span> 
        <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;myNatureImageId&quot;</span>
        <span style="color: #a6e22e">natureId=</span><span style="color: #e6db74">&quot;myNatureId&quot;</span>
        <span style="color: #a6e22e">icon=</span><span style="color: #e6db74">&quot;icons/sample.gif&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/image&gt;</span>
     <span style="color: #f92672">&lt;/extension&gt;</span> 
</pre></td></tr></table></div>
  

Это самый простой способ. Но он имеет ограничение: Необходимо, чтобы наша Nature myNatureId шла первой в списке Nature для проекта. Поскольку проект может иметь несколько разных nature и наша nature далеко не всегда может идти первой. Текущее расположение порядка nature можно посмотреть в файле .project
<br /><br />
<b>2)</b> Создать декоратор. Точка расширения - <b>"org.eclipse.ui.decorators"</b>
<br /><br />
    <!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="color: #777; margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">&lt;extension</span> <span style="color: #a6e22e">point=</span><span style="color: #e6db74">&quot;org.eclipse.ui.decorators&quot;</span><span style="color: #f92672">&gt;</span>
        <span style="color: #f92672">&lt;decorator</span>
            <span style="color: #a6e22e">id=</span><span style="color: #e6db74">&quot;myProjectDecoratorId&quot;</span> 
            <span style="color: #a6e22e">label=</span><span style="color: #e6db74">&quot;My Project Decorator&quot;</span> 
            <span style="color: #a6e22e">state=</span><span style="color: #e6db74">&quot;true&quot;</span> 
            <span style="color: #a6e22e">lightweight=</span><span style="color: #e6db74">&quot;true&quot;</span> 
            <span style="color: #a6e22e">icon=</span><span style="color: #e6db74">&quot;icons/sample.gif&quot;</span> 
            <span style="color: #a6e22e">location=</span><span style="color: #e6db74">&quot;TOP_RIGHT&quot;</span>
            <span style="color: #a6e22e">adaptable=</span><span style="color: #e6db74">&quot;true&quot;</span>
            <span style="color: #f92672">&gt;</span> 
            <span style="color: #f92672">&lt;enablement&gt;</span>
            <span style="color: #f92672">&lt;and&gt;</span>
              <span style="color: #f92672">&lt;objectClass</span> <span style="color: #a6e22e">name=</span><span style="color: #e6db74">&quot;org.eclipse.core.resources.IResource&quot;</span><span style="color: #f92672">/&gt;</span>
              <span style="color: #f92672">&lt;objectState</span>
                  <span style="color: #a6e22e">name=</span><span style="color: #e6db74">&quot;nature&quot;</span>
                  <span style="color: #a6e22e">value=</span><span style="color: #e6db74">&quot;myNatureId&quot;</span><span style="color: #f92672">&gt;</span>
              <span style="color: #f92672">&lt;/objectState&gt;</span>                              
            <span style="color: #f92672">&lt;/and&gt;</span>              
            <span style="color: #f92672">&lt;/enablement&gt;</span>
            <span style="color: #f92672">&lt;description&gt;</span>
              <span style="color: #fff">Пример работы декоратора</span>
            <span style="color: #f92672">&lt;/description&gt;</span>

        <span style="color: #f92672">&lt;/decorator&gt;</span>
    <span style="color: #f92672">&lt;/extension&gt;</span> 
</pre></td></tr></table></div>

<br />

<h4>Примечание:</h4>

<a class="psy_img_up" title="eclipse custom project nature icons" href="./images/eclipse/plugin/eclipse-custom-project-nature-icons.png">
<img style="width:220px; margin-left:20px; margin-bottom:10px;" align="right" src="./images/eclipse/plugin/eclipse-custom-project-nature-icons-300.png" />
 </a>

<ul>
<li>
<b>state</b>(true/false) - флаг обозначает, активирован ли декоратор по умолчанию. Значение по умолчанию данного флага - false. Отключить / включить декоратор во время работы в Eclipse можно, зайдя в <i>Preferences > General > Appearance > Label Decorations</i><br /><br />
</li><li>
<b>lightweight</b> (true/false) - более поздний и функциональный из двух типов декораторов. реализует интерфейс <i>org.eclipse.jface.viewers.ILightweightLabelDecorator</i> В случае lightweight декоратора нет необходимости указывать класс декоратора, в котором описывать работу с изображениями. Все манипуляции с картинками lightweight декоратор берет на себя. Достаточно указать лишь 2 параметра: <i>icon</i> и <i>location</i><br /><br />
</li><li>
<b>adaptable</b> (true/false) - что данное свойство распространяется и на объекты, чьи типы могут быть адаптированы к типу, указанному в objectClass.
</li></ul>
<h4>Ссылки:</h4>
<ol><li>
<a rel="nofollow" href="http://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fextension-points%2Forg_eclipse_ui_decorators.html">Eclipse Help - Decorators</a>
</li><li>
<a rel="nofollow" href="http://www.eclipse.org/articles/Article-Decorators/decorators.html#New">Understanding Decorators in Eclipse</a>
</li></ol>


    </div>
    
    <div class='psy_page_tags'><ul class='tags'><li class='blue' ><a href='./search/label/eclipse.html'>eclipse <span>4</span></a></li> <li><a href='./search/label/plug-in_development.html'>plug-in development <span>4</span></a></li> </ul></div>
 

    <div class="cleaner"></div>
</div>
<div class="psytronica_post_intro"></div>

<div class="psytronica_post even  psy_post_tags">
    <h2><a href="./2015/10/eclipse-ivaluevariable-idynamicvariable.html">Переменные в плагинах Eclipse. Интерфейсы IValueVariable и IDynamicVariable</a></h2>

    <div class="date"><div class='psy_page_date'>22.10.2015</div></div>

    <div class="psytronica_post_content" >
        
<div dir="ltr" style="text-align: left;" trbidi="on">
<b>IValueVariable</b> - переменные, которым присваивается какое-то конкретное значение и которые не принимают на вход аргументы.<br />
<br />
&nbsp;Чтобы создать такие переменные, можно указать в <b>plugin.xml</b> точку расширения "<b>org.eclipse.core.variables.valueVariables</b>":
таким образом, заданы 2 переменные <b>coffeevar</b> и <b>othervar

</b><!-- HTML generated using hilite.me --><br />
<br />
<div style="background: #272822; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;">
<table><tbody>
<tr><td><pre style="line-height: 125%; margin: 0;"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre>
</td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #f92672;">&lt;extension</span>
     <span style="color: #a6e22e;">point=</span><span style="color: #e6db74;">"org.eclipse.core.variables.valueVariables"</span><span style="color: #f92672;">&gt;</span>
  <span style="color: #f92672;">&lt;variable</span>
        <span style="color: #a6e22e;">initialValue=</span><span style="color: #e6db74;">"arabica"</span>
        <span style="color: #a6e22e;">name=</span><span style="color: #e6db74;">"coffeevar"</span>
        <span style="color: #a6e22e;">description=</span><span style="color: #e6db74;">"Some sort of coffee"</span><span style="color: #f92672;">&gt;</span>
  <span style="color: #f92672;">&lt;/variable&gt;</span>
  <span style="color: #f92672;">&lt;variable</span>
        <span style="color: #a6e22e;">initialValue=</span><span style="color: #e6db74;">"другое значение"</span>
        <span style="color: #a6e22e;">name=</span><span style="color: #e6db74;">"othervar"</span>
        <span style="color: #a6e22e;">description=</span><span style="color: #e6db74;">"описание другой переменной"</span><span style="color: #f92672;">&gt;</span>
  <span style="color: #f92672;">&lt;/variable&gt;</span>      
<span style="color: #f92672;">&lt;/extension&gt;</span>
</pre>
</td></tr>
</tbody></table>
</div>
(Аналогично, можно на вкладке "<b>Extensions</b>" при открытии plugin.xml добавить указанную точку расширения и добавить 2 указанные переменные)<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a class="psy_img_up" title="Переменные в плагинах Eclipse. Интерфейсы IValueVariable и IDynamicVariable" href="./images/eclipse/plugin/eclipse-variables.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="152" src="./images/eclipse/plugin/eclipse-variables-min.png" width="320" /></a></div>
<br />
<br />
<br />
В <b>MANIFEST.MF</b> необходимо добавить  org.eclipse.core.variables в <b>Require-Bundle&nbsp;</b><br />
Получить значения переменных из кода можно при помощи интерфейса <b>IStringVariableManager</b>:

<!-- HTML generated using hilite.me --><br />
<br />
<div style="background: #272822; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;">
<table><tbody>
<tr><td><pre style="line-height: 125%; margin: 0;">1</pre>
</td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #f8f8f2;">IValueVariable</span> <span style="color: #f8f8f2;">varVal</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">VariablesPlugin</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getDefault</span><span style="color: #f92672;">().</span><span style="color: #a6e22e;">getStringVariableManager</span><span style="color: #f92672;">().</span><span style="color: #a6e22e;">getValueVariable</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">myStr</span><span style="color: #f92672;">);</span>
</pre>
</td></tr>
</tbody></table>
</div>
<br />
где myStr - значение поля "<b>name</b>" тега variable

Пример доступа к значениям переменных:

<!-- HTML generated using hilite.me --><br />
<br />
</div>

    </div>
    <span class='readmore'><a class='psy_readmore' href='./2015/10/eclipse-ivaluevariable-idynamicvariable.html'>Дальше >></a></span>
    <div class='psy_page_tags'><ul class='tags'><li class='blue' ><a href='./search/label/eclipse.html'>eclipse <span>4</span></a></li> <li><a href='./search/label/plug-in_development.html'>plug-in development <span>4</span></a></li> </ul></div>
 

    <div class="cleaner"></div>
</div>
<div class="psytronica_post_intro"></div>

<div class="psytronica_post even  psy_post_tags">
    <h2><a href="./2015/10/eclipse-ubuntu-linux.html">Открыть ресурс в файловом менеджере - плагин для Eclipse под Ubuntu Linux.</a></h2>

    <div class="date"><div class='psy_page_date'>19.10.2015</div></div>

    <div class="psytronica_post_content" >
        
<div dir="ltr" style="text-align: left;" trbidi="on">
Передо мной встала задачка - создать плагин для Eclipse, позволяющий открывать директорию выбранного файла/папки/проекта в дереве проектов Package Explorer. Директория открывается при выборе соответсвующего пункта контекстного меню или нажатия комбинации клавиш (CTRL+8)<br />
<br />
В результате получилось следующее:<br />
<div class="separator" style="clear: both; text-align: center;">
<a class="psy_img_up" title="Открыть ресурс в файловом менеджере - плагин для Eclipse под Ubuntu Linux." href="./images/eclipse/plugin/eclipse-open-in-file-manager.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="276" src="./images/eclipse/plugin/eclipse-open-in-file-manager-min.png" width="320" /></a></div>
<br />
<br />
Расскажу как делала по шагам:<br />
<br />
1) Для начала создаю сам проект com.zygo.openfolder на базе шаблона "Hello, World Command"<br />
(см. Welcome -&gt; Eclipse Plug-in Development -&gt; Create a plug-in)<br />
На последнем шаге указываю: Handler Class Name - ZygoHandler<br />
<br />
2) Вношу изменения в созданный plugin.xml<br />
(Для этого можно открыть plugin.xml и выбрать нижнюю вкладку "plugin.xml")<br />
<br />
Заменяю часть кода:<br />
<br />
&nbsp; &nbsp;&lt;extension<br />
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;point="org.eclipse.ui.menus"&gt;<br />
&nbsp; &nbsp; &nbsp; &nbsp; ....<br />
&nbsp; &nbsp; &lt;/extension&gt;<br />
<br />
На<br />
<br />
<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></td><td><pre style="margin: 0; line-height: 125%">   <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">extension</span>
         <span style="color: #f8f8f2">point</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;org.eclipse.ui.menus&quot;</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">menuContribution</span>
            <span style="color: #f8f8f2">locationURI</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;popup:org.eclipse.jdt.ui.PackageExplorer&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">command</span>
                  <span style="color: #f8f8f2">commandId</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;com.zygo.openfolder.commands.sampleCommand&quot;</span>
                  <span style="color: #f8f8f2">icon</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;icons/sample.gif&quot;</span>
                  <span style="color: #f8f8f2">tooltip</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;Open Containing Folder&quot;</span>
                  <span style="color: #f8f8f2">id</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;com.zygo.openfolder.toolbars.sampleCommand&quot;</span>
                  <span style="color: #f8f8f2">label</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;Show in FileManager&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">command</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">menuContribution</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">menuContribution</span>
            <span style="color: #f8f8f2">locationURI</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;popup:org.eclipse.ui.navigator.ProjectExplorer#PopupMenu&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">command</span>
                  <span style="color: #f8f8f2">commandId</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;com.zygo.openfolder.commands.sampleCommand&quot;</span>
                  <span style="color: #f8f8f2">icon</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;icons/sample.gif&quot;</span>
                  <span style="color: #f8f8f2">tooltip</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;Open Containing Folder&quot;</span>
                  <span style="color: #f8f8f2">id</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;com.zygo.openfolder.toolbars.sampleCommand&quot;</span>
                  <span style="color: #f8f8f2">label</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;Show in FileManager&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">command</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">menuContribution</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">menuContribution</span>
            <span style="color: #f8f8f2">locationURI</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;popup:org.python.pydev.navigator.view#PopupMenu&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">command</span>
                  <span style="color: #f8f8f2">commandId</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;com.zygo.openfolder.commands.sampleCommand&quot;</span>
                  <span style="color: #f8f8f2">icon</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;icons/sample.gif&quot;</span>
                  <span style="color: #f8f8f2">tooltip</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;Open Containing Folder&quot;</span>
                  <span style="color: #f8f8f2">id</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;com.zygo.openfolder.toolbars.sampleCommand&quot;</span>
                  <span style="color: #f8f8f2">label</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;Show in FileManager&quot;</span><span style="color: #f92672">&gt;</span>
            <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">command</span><span style="color: #f92672">&gt;</span>
      <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">menuContribution</span><span style="color: #f92672">&gt;</span>     
   <span style="color: #f92672">&lt;/</span><span style="color: #f8f8f2">extension</span><span style="color: #f92672">&gt;</span>
</pre></td></tr></table></div>

<br />
Я добавляю три почти одинаковых тега menuContribution для того, чтобы новый пункт контекстного меню отображался в Package Explorer (для перспективы Java), в Project Explorer (напр. для отображения в перспективе Plug-in Development) и в PyDev Package Explorer.<br />
Выбор трех указанных эксплореров определялся непосредственно моей задачкой - по большей части я занимаюсь разработкой в перспективе PyDev.<br />
<br />
Существует, конечно, другой вариант: &lt;extension point="org.eclipse.ui.popupMenus"&gt;, но я решила им не пользоваться, поскольку данный extension point уже deprecated и имеет ряд ограничений - например, сложность с привязыванием комбинации клавиш (решение есть, но довольно громоздкое) и прочие неудобства.<br />
<br />
3) В файла src / com.zygo.openfolder.handlers / ZygoHandler.java добавляю следующий код:<br />
<br />
<br />
<!-- HTML generated using hilite.me --><br />
<div style="background: #272822; border-width: .1em .1em .1em .8em; border: solid gray; overflow: auto; padding: .2em .6em; width: auto;">
<table><tbody>
<tr><td><pre style="line-height: 125%; margin: 0;"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre>
</td><td><pre style="line-height: 125%; margin: 0;"><span style="color: #f92672;">package</span> <span style="color: #f8f8f2;">com</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">zygo</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">openfolder</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">handlers</span><span style="color: #f92672;">;</span>

<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">java.io.IOException</span><span style="color: #f92672;">;</span>

<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.core.commands.AbstractHandler</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.core.commands.ExecutionEvent</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.core.commands.ExecutionException</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.core.resources.IResource</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.core.runtime.IAdaptable</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.ui.handlers.HandlerUtil</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.jface.viewers.ISelection</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.jface.viewers.IStructuredSelection</span><span style="color: #f92672;">;</span>
<span style="color: #f92672;">import</span> <span style="color: #f8f8f2;">org.eclipse.jface.viewers.TreeSelection</span><span style="color: #f92672;">;</span>


<span style="color: #66d9ef;">public</span> <span style="color: #66d9ef;">class</span> <span style="color: #a6e22e;">ZygoHandler</span> <span style="color: #66d9ef;">extends</span> <span style="color: #f8f8f2;">AbstractHandler</span> <span style="color: #f92672;">{</span>
 
 <span style="color: #75715e;">// файловый менеджер в убунту по умолчанию</span>
 <span style="color: #75715e;">// при запуске "xdg-open /path/to/location" откроет файловый менеджер в</span>
 <span style="color: #75715e;">// директории /path/to/location</span>
 <span style="color: #66d9ef;">private</span> <span style="color: #f8f8f2;">String</span> <span style="color: #f8f8f2;">DefaultUbuntuFilemanager</span> <span style="color: #f92672;">=</span> <span style="color: #e6db74;">"xdg-open"</span><span style="color: #f92672;">;</span>

   <span style="color: #f8f8f2;">IResource</span> <span style="color: #a6e22e;">extractSelection</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">ISelection</span> <span style="color: #f8f8f2;">sel</span><span style="color: #f92672;">)</span> <span style="color: #f92672;">{</span>
       <span style="color: #66d9ef;">if</span> <span style="color: #f92672;">(!(</span><span style="color: #f8f8f2;">sel</span> <span style="color: #66d9ef;">instanceof</span> <span style="color: #f8f8f2;">IStructuredSelection</span><span style="color: #f92672;">))</span>
          <span style="color: #66d9ef;">return</span> <span style="color: #66d9ef;">null</span><span style="color: #f92672;">;</span>
       <span style="color: #f8f8f2;">IStructuredSelection</span> <span style="color: #f8f8f2;">ss</span> <span style="color: #f92672;">=</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">IStructuredSelection</span><span style="color: #f92672;">)</span> <span style="color: #f8f8f2;">sel</span><span style="color: #f92672;">;</span>
       <span style="color: #f8f8f2;">Object</span> <span style="color: #f8f8f2;">element</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">ss</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getFirstElement</span><span style="color: #f92672;">();</span>
       <span style="color: #66d9ef;">if</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">element</span> <span style="color: #66d9ef;">instanceof</span> <span style="color: #f8f8f2;">IResource</span><span style="color: #f92672;">)</span>
          <span style="color: #66d9ef;">return</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">IResource</span><span style="color: #f92672;">)</span> <span style="color: #f8f8f2;">element</span><span style="color: #f92672;">;</span>
       <span style="color: #75715e;">// @TODO: if (element instanceof SourceMember) ...      </span>
       <span style="color: #66d9ef;">if</span> <span style="color: #f92672;">(!(</span><span style="color: #f8f8f2;">element</span> <span style="color: #66d9ef;">instanceof</span> <span style="color: #f8f8f2;">IAdaptable</span><span style="color: #f92672;">)){</span>
          <span style="color: #66d9ef;">return</span> <span style="color: #66d9ef;">null</span><span style="color: #f92672;">;</span>
       <span style="color: #f92672;">}</span>
       <span style="color: #f8f8f2;">IAdaptable</span> <span style="color: #f8f8f2;">adaptable</span> <span style="color: #f92672;">=</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">IAdaptable</span><span style="color: #f92672;">)</span><span style="color: #f8f8f2;">element</span><span style="color: #f92672;">;</span>
       <span style="color: #f8f8f2;">Object</span> <span style="color: #f8f8f2;">adapter</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">adaptable</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getAdapter</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">IResource</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">class</span><span style="color: #f92672;">);</span>
       <span style="color: #66d9ef;">return</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">IResource</span><span style="color: #f92672;">)</span> <span style="color: #f8f8f2;">adapter</span><span style="color: #f92672;">;</span>
 <span style="color: #f92672;">}</span>
 
 <span style="color: #66d9ef;">public</span> <span style="color: #f8f8f2;">Object</span> <span style="color: #a6e22e;">execute</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">ExecutionEvent</span> <span style="color: #f8f8f2;">event</span><span style="color: #f92672;">)</span> <span style="color: #66d9ef;">throws</span> <span style="color: #f8f8f2;">ExecutionException</span> <span style="color: #f92672;">{</span>

  <span style="color: #75715e;">// определяем, что выделено в данный момент</span>
  <span style="color: #f8f8f2;">ISelection</span> <span style="color: #f8f8f2;">selection</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">HandlerUtil</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getCurrentSelectionChecked</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">event</span><span style="color: #f92672;">);</span>
  
  <span style="color: #66d9ef;">if</span> <span style="color: #f92672;">(!(</span><span style="color: #f8f8f2;">selection</span> <span style="color: #66d9ef;">instanceof</span> <span style="color: #f8f8f2;">TreeSelection</span><span style="color: #f92672;">)){</span>
   <span style="color: #66d9ef;">return</span> <span style="color: #66d9ef;">null</span><span style="color: #f92672;">;</span>
  <span style="color: #f92672;">}</span>
  
  <span style="color: #f8f8f2;">IResource</span> <span style="color: #f8f8f2;">res</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">extractSelection</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">selection</span><span style="color: #f92672;">);</span>
  
  <span style="color: #66d9ef;">if</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">res</span> <span style="color: #f92672;">==</span> <span style="color: #66d9ef;">null</span><span style="color: #f92672;">){</span>
   <span style="color: #66d9ef;">return</span> <span style="color: #66d9ef;">null</span><span style="color: #f92672;">;</span>
  <span style="color: #f92672;">}</span>
  
        <span style="color: #f8f8f2;">String</span> <span style="color: #f8f8f2;">folderPath</span> <span style="color: #f92672;">=</span> <span style="color: #e6db74;">""</span><span style="color: #f92672;">;</span>       
      
        <span style="color: #75715e;">// 1 соотвествует файлу, 2 - директория, 4 - проект</span>
      
        <span style="color: #66d9ef;">if</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">res</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getType</span><span style="color: #f92672;">()</span> <span style="color: #f92672;">==</span> <span style="color: #ae81ff;">1</span><span style="color: #f92672;">){</span>
         <span style="color: #f8f8f2;">folderPath</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">res</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getParent</span><span style="color: #f92672;">().</span><span style="color: #a6e22e;">getLocation</span><span style="color: #f92672;">().</span><span style="color: #a6e22e;">toString</span><span style="color: #f92672;">();</span> 
        <span style="color: #f92672;">}</span><span style="color: #66d9ef;">else</span> <span style="color: #66d9ef;">if</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">res</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getType</span><span style="color: #f92672;">()</span> <span style="color: #f92672;">==</span> <span style="color: #ae81ff;">2</span> <span style="color: #f92672;">||</span> <span style="color: #f8f8f2;">res</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getType</span><span style="color: #f92672;">()</span> <span style="color: #f92672;">==</span> <span style="color: #ae81ff;">4</span><span style="color: #f92672;">){</span>
         <span style="color: #f8f8f2;">folderPath</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">res</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getLocation</span><span style="color: #f92672;">().</span><span style="color: #a6e22e;">toString</span><span style="color: #f92672;">();</span>
        <span style="color: #f92672;">}</span>
      
  <span style="color: #66d9ef;">if</span><span style="color: #f92672;">(!</span><span style="color: #f8f8f2;">folderPath</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">isEmpty</span><span style="color: #f92672;">()){</span>
   <span style="color: #66d9ef;">try</span> <span style="color: #f92672;">{</span>
       <span style="color: #f8f8f2;">String</span> <span style="color: #f8f8f2;">command</span> <span style="color: #f92672;">=</span> <span style="color: #f8f8f2;">DefaultUbuntuFilemanager</span><span style="color: #f92672;">+</span><span style="color: #e6db74;">" "</span><span style="color: #f92672;">+</span><span style="color: #f8f8f2;">folderPath</span><span style="color: #f92672;">;</span>
       <span style="color: #f8f8f2;">Runtime</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">getRuntime</span><span style="color: #f92672;">().</span><span style="color: #a6e22e;">exec</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">command</span><span style="color: #f92672;">);</span>
      <span style="color: #f92672;">}</span> <span style="color: #66d9ef;">catch</span> <span style="color: #f92672;">(</span><span style="color: #f8f8f2;">IOException</span> <span style="color: #f8f8f2;">e</span><span style="color: #f92672;">)</span> <span style="color: #f92672;">{</span>
       <span style="color: #f8f8f2;">System</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">out</span><span style="color: #f92672;">.</span><span style="color: #a6e22e;">println</span><span style="color: #f92672;">(</span><span style="color: #f8f8f2;">e</span><span style="color: #f92672;">);</span>
      <span style="color: #f92672;">}</span>
  <span style="color: #f92672;">}</span>       
      
  <span style="color: #66d9ef;">return</span> <span style="color: #66d9ef;">null</span><span style="color: #f92672;">;</span>
 <span style="color: #f92672;">}</span>
<span style="color: #f92672;">}</span>
</pre>
</td></tr>
</tbody></table>
</div>
<br />
Вместо "xdg-open" можно подставить другой файловый менеджер, принимающий на вход как аргумент путь к нужной директории.<br />
<br />
<br />
Еще я заменила комбинацию клавиш с CTRL+6 (стандартной), на нужную мне.<br />
В plugin.xml &lt;extension point="org.eclipse.ui.bindings"&gt; в теге key вместо опции sequence="M1+6" (т.е. CTRL+6) я поставила CTRL+8.<br />
M1, M2 и M3 соотвествуют клавишам CTRL, SHIFT и ALT. Т.е., если бы я хотела выбрать комбинацию клавиш CTRL+SHIFT+3, я могла бы использовать M1+M2+3<br />
<br />
Вот и все. Собираю стандартными средствами эклипса jar-aрхив (Вкладка "Overview" &gt; "Exporting" в plugin.xml), затем помещаю его в директорию эклипса dropins. Работает!<br />
<br />
Критика, советы и пожелания приветствуются.</div>


    </div>
    
    <div class='psy_page_tags'><ul class='tags'><li class='blue' ><a href='./search/label/eclipse.html'>eclipse <span>4</span></a></li> <li><a href='./search/label/filemanager.html'>filemanager <span>1</span></a></li> <li><a href='./search/label/ubuntu.html'>ubuntu <span>1</span></a></li> <li><a href='./search/label/plug-in_development.html'>plug-in development <span>4</span></a></li> </ul></div>
 

    <div class="cleaner"></div>
</div>
<div class="psytronica_post_intro"></div>

</div>


            </div>
            <div id="psytronica_right_column">
                <div id="psytronica_right_column_inset">
                    <div id="psytronica_right_column_inner">
                      <div id="psytronica_right_column_innering">
                        
<h5>Облако тегов</h5>
<div class='psy_tags2'><a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/cke.html'>cke<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='4' style='font-size:14px; color:rgba(255, 163, 80, 1)' href='./search/label/eclipse.html'>eclipse<span>&nbsp;(4)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/filemanager.html'>filemanager<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/inno.html'>inno<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/jlnodoubles.html'>jlnodoubles<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='8' style='font-size:20px; color:rgba(255, 221, 173, 1)' href='./search/label/joomla.html'>joomla<span>&nbsp;(8)</span></a> <a class='psy_tag_calc_link' tagcount='2' style='font-size:11px; color:rgba(255, 111, 73, 1)' href='./search/label/joomshopping.html'>joomshopping<span>&nbsp;(2)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/php.html'>php<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='4' style='font-size:14px; color:rgba(255, 163, 80, 1)' href='./search/label/plug-in_development.html'>plug-in development<span>&nbsp;(4)</span></a>  <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/shnodoubles.html'>shnodoubles<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/tiddlyWiki.html'>tiddlyWiki<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/ubuntu.html'>ubuntu<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='4' style='font-size:14px; color:rgba(255, 163, 80, 1)' href='./search/label/zygo_profile.html'>zygo_profile<span>&nbsp;(4)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/друзья.html'>друзья<span>&nbsp;(1)</span></a> <a class='psy_tag_calc_link' tagcount='4' style='font-size:14px; color:rgba(255, 163, 80, 1)' href='./search/label/разработки.html'>разработки<span>&nbsp;(4)</span></a> <a class='psy_tag_calc_link' tagcount='1' style='font-size:10px; color:rgba(255, 80, 80, 1)' href='./search/label/санскрит.html'>санскрит<span>&nbsp;(1)</span></a> </div>
 
<h5>Меню</h5>
<ul class="psy_right_menu">
<li><a href='./#blog' class='psy_noactive'>Главная</a></li>
<li><a href='./section/Создание_собственного_отладчика_в_Eclipse.html' class='psy_noactive'>Создание собственного отладчика в Eclipse</a></li>
<li><a href='./section/санскрит.html' class='psy_noactive'>Санскрит - немножко перевожу</a></li>
<li><a href='./section/camino_latino.html' class='psy_noactive'>Camino Latino - истории о латинской америке</a></li>
</ul>
<h5>Архив</h5>
<div class='psy_archive'>
    <div class='psy_archive_elems' style='display:none'>
            <span class='el_open'>&#9660;&#160;</span>
            <span class='el_closed'>&#9658;&#160;</span>
    </div>
    <ul class='psy_archive_years'><li class='last_year' >
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-open'>&#9660;&#160;</span>
                    </a>
                    <a class='psy_year_title' href='#'>2017</a><ul class='psy_archive_mons'><li class='last_month' >
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-open'>&#9660;&#160;</span>
                    </a>
                    <a class='psy_mon_title' href='#'>03</a><ul class='psy_archive_days'><li><a href='./2017/03/eclipse-wizard-open-programmatically.html'>Вызов wizard'а в Eclipse по кнопке или по shortcut'y в меню</a></li><li><a href='./2017/03/eclipse-custom-project-nature-icons.html'>Eclipse: особые иконки в Project Explorer для проекта с определенной Nature</a></li></ul></li><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_mon_title' href='#'>02</a><ul class='psy_archive_days'><li><a href='./2017/02/joomshopping-list-to-text-attribute.html'>Joomshopping - замена выпадающих списков с единственным элементом на текст в независимых атрибутах</a></li><li><a href='./2017/02/cke-joomla3-problem.html'>Фикс: проблема с CKE-редактором под Joomla 3</a></li><li><a href='./2017/02/zygo-profile-autoupdates-webcam.html'>Новый релиз Zygo Profile: автообновления, камера, поддержка Joomla 3.7</a></li><li><a href='./2017/02/Zygo-Joomshopping-Review-Captcha.html'>Zygo Joomshopping Review Captcha - капча KCaptcha для отзывов в интернет-магазине Joomshopping</a></li><li><a href='./2017/02/svetomaster_video.html'>Подарок от Евгения</a></li><li><a href='./2017/02/inno-recursive-file-copy-timestamps.html'>Inno - создание инсталлятора. Рекурсивное копирование файлов внешней директории, учитывая даты.</a></li></ul></li><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_mon_title' href='#'>01</a><ul class='psy_archive_days'><li><a href='./2017/01/tiddlywiki-php7-last-backups-store.html'>TiddlyWiki: сохранение 10 последних резервных копий на сервере.</a></li></ul></li></ul></li><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_year_title' href='#'>2016</a><ul class='psy_archive_mons'><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_mon_title' href='#'>11</a><ul class='psy_archive_days'><li><a href='./2016/11/zygoprofile-checkbox-checkboxes-html_88.html'>ZygoProfile: добавлены поля checkbox, checkboxes, html</a></li></ul></li><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_mon_title' href='#'>10</a><ul class='psy_archive_days'><li><a href='./2016/10/zygoprofile.html'>ZygoProfile - назначение полей группам пользователей.</a></li><li><a href='./2016/10/shabdatra.html'>Санскрит -  запоминание глагольных форм</a></li></ul></li></ul></li><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_year_title' href='#'>2015</a><ul class='psy_archive_mons'><li>
                    <a class='toggle' href='javascript:void(0)'>
                        <span class='zippy toggle-closed'>&#9658;&#160;</span>
                    </a>
                    <a class='psy_mon_title' href='#'>10</a><ul class='psy_archive_days'><li><a href='./2015/10/joomla-3x-zygoprofile-hkmprofile.html'>Плагин расширенного профиля Joomla 3.x с поддержкой аватаров (обработка имиджей, обрезка миниатюр) - Zygo Profile</a></li><li><a href='./2015/10/eclipse-ivaluevariable-idynamicvariable.html'>Переменные в плагинах Eclipse. Интерфейсы IValueVariable и IDynamicVariable</a></li><li><a href='./2015/10/verbos-irregulares-android-kivy-python.html'>Verbos irregulares - приложение для android для запоминания неправильных испанских глаголов.</a></li><li><a href='./2015/10/eclipse-ubuntu-linux.html'>Открыть ресурс в файловом менеджере - плагин для Eclipse под Ubuntu Linux.</a></li></li></ul></li></ul></div>

                      </div>
                    </div>
                    <div id="psytronica_right_column_inner_after"></div>
                </div>

            </div>
          	<div class="cleaner"></div>
        </div>
        <div id="psy_after_main"></div>
        
    </div>
</div>

<div class="cleaner"></div>



<div id="psytronica_cr_bar_wrapper">
	<div id="psytronica_cr_bar">
    	
© Psytronica.ru. Блог существа SherZa. 2015-2017

        <a href="#top" class="to_anchor">Наверх</a>
    </div>
</div>


<div id="dsq-count-scr-wrapper"></div>



  

<!-- Yandex.Metrika counter -->
<script type="text/javascript">
  $(document).ready(function(){

    (function (d, w, c) {
        (w[c] = w[c] || []).push(function() {
            try {
                w.yaCounter33338883 = new Ya.Metrika({
                    id:33338883,
                    clickmap:true,
                    trackLinks:true,
                    accurateTrackBounce:true
                });
            } catch(e) { }
        });

        var n = d.getElementsByTagName("script")[0],
            s = d.createElement("script"),
            f = function () { n.parentNode.insertBefore(s, n); };
        s.type = "text/javascript";
        s.async = true;
        s.src = "https://mc.yandex.ru/metrika/watch.js";

        if (w.opera == "[object Opera]") {
            d.addEventListener("DOMContentLoaded", f, false);
        } else { f(); }
    })(document, window, "yandex_metrika_callbacks");
  });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/33338883" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->


<script>
  $(document).ready(function(){
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-91608488-1', 'auto');
  ga('send', 'pageview');
  });
</script>

</div>  
 <style>
   body{
   	background: #2d261a;
   }
   body #psy_body_inner{
		opacity:1;
    } 
  </style> 
</body>
</html>

